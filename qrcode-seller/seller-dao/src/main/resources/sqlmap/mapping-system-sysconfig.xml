<?xml version="1.0" encoding="UTF-8" ?>    
<!DOCTYPE mapper    
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SYSTEM">

	<resultMap id="RM-SYSCONFIG" type="TA-SYSCONFIG">
		<result property="configID" column="CONFIG_ID" />
		<result property="name" column="NAME" />
		<result property="code" column="CODE" />
		<result property="valuess" column="VALUESS" />
		<result property="isSingleValue" column="IS_SINGLE_VALUE" />

		<result property="dataType" column="DATA_TYPE" />
		<result property="meto" column="METO" />
		<result property="hold1" column="HOLD1" />
		<result property="hold2" column="HOLD2" />
		<result property="createTime" column="CREATE_TIME" />
		
		<result property="updateTime" column="UPDATE_TIME" />
	</resultMap>


	<!-- 系统配置的公共查询ＳＱＬ -->
	<sql id="SQL_SELECT_SYSCONFIG">
		<![CDATA[
			SELECT a.CONFIG_ID, 
					a.NAME, 
					a.CODE,
					a.VALUESS,
					a.IS_SINGLE_VALUE,
					a.DATA_TYPE,
					a.METO,
			    	a.HOLD1,
			    	a.HOLD2,
			    	a.CREATE_TIME,
			    	a.UPDATE_TIME
			FROM TB_SYS_CONFIG  a
	   ]]>
	</sql>


	<!-- 系统配置的公共查询条件 -->
	<sql id="SQL_WHERE_SYSCONFIG">
		<if test="configID != null and configID !=''">
			AND a.CONFIG_ID = #{configID}
		</if>
		<if test="code != null and code !=''">
			AND a.CODE = #{code}
		</if>
		<if test="name != null and name !=''">
			AND a.NAME like  '%' ||  #{name}
		</if>
	</sql>
	
	
	<!-- 创建配置信息 -->
	<insert id="INSERT_SYSCONFIG" parameterType="TA-SYSCONFIG">
		INSERT INTO TB_SYS_CONFIG  ( CONFIG_ID , NAME, CODE, VALUESS, 
			IS_SINGLE_VALUE, DATA_TYPE, METO, HOLD1, HOLD2, CREATE_TIME, UPDATE_TIME) 
		VALUES (#{configID}, #{name},  #{code},   #{valuess},  #{isSingleValue}, 
		        #{dataType},  #{meto},  #{hold1},#{hold2},#{createTime}, #{updateTime}) 
	   	<selectKey resultType="java.lang.Long" keyProperty="configID">  
        	SELECT LAST_INSERT_ID() AS CONFIG_ID 
	    </selectKey>
	</insert>


	<!-- 更新配置信息 -->
	<update id="UPDATE_SYSCONFIG" parameterType="TA-SYSCONFIG">
		UPDATE TB_SYS_CONFIG SET NAME = #{name}, VALUESS = #{valuess},
			IS_SINGLE_VALUE = #{isSingleValue}, DATA_TYPE = #{dataType}, METO = #{meto},HOLD1 = #{hold1}, HOLD2 = #{hold2}, UPDATE_TIME= #{updateTime}
		WHERE CONFIG_ID = #{configID}
	</update>


	<!-- 根据配置ID获取配置信息 -->
	<select id="FIND_SYSCONFIG_BY_ID" parameterType="java.lang.Long"
		resultMap="RM-SYSCONFIG">
		<include refid="SQL_SELECT_SYSCONFIG" /> WHERE a.CONFIG_ID = #{value}
	</select>
	
	<!-- 根据配置CODE获取配置信息 -->
	<select id="FIND_SYSCONFIG_BY_CODE" parameterType="java.lang.String"
		resultMap="RM-SYSCONFIG">
		<include refid="SQL_SELECT_SYSCONFIG" /> WHERE a.CODE = #{value}
	</select>

	
	<!-- 根据名称，ID或CODE组合查询配置信息 -->
	<select id="FIND_SYSCONFIG_BY_DTO" parameterType="TA-SYSCONFIG-DTO" resultMap="RM-SYSCONFIG">
		<include refid="SQL_SELECT_SYSCONFIG" /> WHERE 1 = 1  
		<include refid="SQL_WHERE_SYSCONFIG"/>
		<include refid="COMMON.PAGINATION"></include>
	</select>
	<select id="FIND_SYSCONFIG_BY_DTO_PAGE_COUNT" parameterType="TA-SYSCONFIG-DTO"
		resultType="java.lang.Integer">
		<![CDATA[
	        SELECT count(1) FROM TB_SYS_CONFIG a WHERE 1 = 1  
	    ]]>
		<include refid="SQL_WHERE_SYSCONFIG" />
	</select>
	
	<!-- 删除配置信息 -->
	<delete id="DELETE_SYSCONFIG" parameterType="java.lang.Long">
		DELETE FROM TB_SYS_CONFIG WHERE CONFIG_ID = #{value}
	</delete>
	
</mapper>
